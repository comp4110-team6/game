[gd_scene load_steps=5 format=2]

[ext_resource path="res://src/ui/fonts/PatuaOne-Regular.ttf" type="DynamicFontData" id=1]
[ext_resource path="res://src/scenes/Bucket.tscn" type="PackedScene" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends Node2D

onready var Orb = preload(\"res://src/scenes/Orb.tscn\")
onready var Orb1
onready var Orb2
onready var Orb3
onready var Orbs = [Orb1, Orb2, Orb3]

var question = \"\"
var answers = []

func _draw():
	OrbsSpawner()

func OrbsSpawner():
	# seed rand
	randomize()
	
	var orb_positions = []
	orb_positions.append((randi() % 352) + 50)
	orb_positions.append((randi() % 356) + 462)
	orb_positions.append((randi() % 352) + 878)
	
	Multiplication()
	
	for i in range(3):
		# instance 3 new orbs
		Orbs[i] = Orb.instance()
		add_child(Orbs[i])
		
		# randomly place orbs into 3 predetermined orb lanes
		Orbs[i].position.x = orb_positions[i]
		
		# randomly assign orbs' speeds
		Orbs[i].speed = (randi() % 51) + 75
		
		Orbs[i].get_node(\"Sprite/Label\").text = String(answers[i].x)
		Orbs[i].IsCorrect = answers[i].y
	
	$Label.text = question

func _process(delta):
	for i in range(3):
		if (int(Orbs[i]) == 0):
			pass
		elif (Orbs[i].position.y + 60 >= 720):
			Orbs[i].queue_free()
			Orbs[i] = 0

func Multiplication():
	# seed rand
	randomize()
	
	var temp_answers = []
	
	# get two numbers, each from 0 to 12
	var num1 = randi() % 13
	var num2 = randi() % 13
	
	question = String(num1) + \" * \" + String(num2)
	
	answers.clear()
	answers.append(Vector2(num1 * num2, 1))
	temp_answers.append(Vector2((num1 * num2) + 1, 0))
	temp_answers.append(Vector2((num1 * num2) - 1, 0))
	temp_answers.append(Vector2((num1 * num2) + num1, 0))
	temp_answers.append(Vector2((num1 * num2) - num1, 0))
	temp_answers.append(Vector2((num1 * num2) + num2, 0))
	temp_answers.append(Vector2((num1 * num2) - num2, 0))
	temp_answers.shuffle()
	answers.append(temp_answers[0])
	answers.append(temp_answers[1])
	answers.shuffle()
"

[sub_resource type="DynamicFont" id=2]
size = 60
font_data = ExtResource( 1 )

[node name="Test" type="Node2D"]
script = SubResource( 1 )

[node name="Label" type="Label" parent="."]
margin_right = 1280.0
margin_bottom = 160.0
custom_fonts/font = SubResource( 2 )
custom_colors/font_color = Color( 0.878431, 0.878431, 0.878431, 1 )
align = 1
valign = 1

[node name="Bucket" parent="." instance=ExtResource( 2 )]
position = Vector2( 640, 660 )
